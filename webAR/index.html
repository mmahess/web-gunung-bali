<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    
    <style>
      body {
        margin: 0;
      }
      #ui-overlay {
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        z-index: 10;
        display: flex;
        justify-content: center;
        align-items: flex-end;
        pointer-events: none;
      }
      #link-button {
        display: none;
        padding: 15px 30px;
        font-size: 18px;
        font-family: sans-serif;
        color: white;
        background-color: #007BFF;
        border: none;
        border-radius: 50px;
        margin-bottom: 50px;
        cursor: pointer;
        pointer-events: auto;
        box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.4);
      }
    </style>
  </head>
  <body>
    <div id="ui-overlay">
      <button id="link-button">Lihat Detail Gunung</button>
    </div>

    <a-scene id="ar-scene" mindar-image="imageTargetSrc: ./targets.mind;" color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
      <a-assets>
        <img id="peta-abang-texture" src="./abang-suter.png">
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity id="target-marker" mindar-image-target="targetIndex: 0">
        <a-image src="#peta-abang-texture"
                 position="0 0 0"
                 scale="2 2 2"
                 rotation="0 0 180">
        </a-image>
      </a-entity>
    </a-scene>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // Logika untuk menampilkan tombol saat target ditemukan sudah benar
        const marker = document.querySelector('#target-marker');
        const button = document.querySelector('#link-button');

        marker.addEventListener("targetFound", event => {
          console.log("Target ditemukan, tampilkan tombol.");
          button.style.display = 'block';
        });

        marker.addEventListener("targetLost", event => {
          console.log("Target hilang, sembunyikan tombol.");
          button.style.display = 'none';
        });
        
        button.addEventListener("click", () => {
          console.log("Tombol HTML diklik!");
          window.location.href = '../detail.html?id=mt03st1';
        });

        // Kita perlu menjalankan MindAR secara manual jika autoStart false,
        // tapi cara termudah adalah dengan menghapus atribut tersebut.
        // const sceneEl = document.querySelector('#ar-scene');
        // sceneEl.systems['mindar-image-system'].start();
      });
    </script>
  </body>
</html>
